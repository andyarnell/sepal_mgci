import component.scripts as cs

results = {
    "2009": {
        "groups": [
            {
                "group": 2,
                "groups": [
                    {"group": 2, "sum": 9.012584721170349},
                    {"group": 3, "sum": 68.44437743621329},
                    {"group": 4, "sum": 79.20185557218142},
                    {"group": 5, "sum": 29.44951926305147},
                    {"group": 10, "sum": 0.4224242577818627},
                ],
            },
            {
                "group": 3,
                "groups": [
                    {"group": 2, "sum": 10.210982422824758},
                    {"group": 3, "sum": 5.614427620894609},
                    {"group": 4, "sum": 529.2282384920047},
                    {"group": 5, "sum": 20.384821304442383},
                    {"group": 6, "sum": 0.7569206875},
                ],
            },
            {
                "group": 4,
                "groups": [
                    {"group": 1, "sum": 30.869439017095576},
                    {"group": 2, "sum": 400.6589821895229},
                    {"group": 3, "sum": 7.107650868351718},
                    {"group": 4, "sum": 2554.1160902336},
                    {"group": 5, "sum": 203.98341383333351},
                    {"group": 6, "sum": 2.6510939068627453},
                    {"group": 10, "sum": 0.2839237734375},
                ],
            },
        ]
    },
    "2010_2015": {
        "groups": [
            {
                "group": 2,
                "groups": [
                    {"group": 2, "groups": [{"group": 2, "sum": 9.012584721170349}]},
                    {"group": 3, "groups": [{"group": 3, "sum": 68.44437743621329}]},
                    {
                        "group": 4,
                        "groups": [
                            {"group": 3, "sum": 0.6053681041053922},
                            {"group": 4, "sum": 78.596487468076},
                        ],
                    },
                    {"group": 5, "groups": [{"group": 5, "sum": 29.44951926305147}]},
                    {"group": 10, "groups": [{"group": 10, "sum": 0.4224242577818627}]},
                ],
            },
            {
                "group": 3,
                "groups": [
                    {
                        "group": 2,
                        "groups": [
                            {"group": 2, "sum": 7.2720158847120135},
                            {"group": 4, "sum": 2.9389665381127457},
                        ],
                    },
                    {"group": 3, "groups": [{"group": 3, "sum": 5.614427620894609}]},
                    {
                        "group": 4,
                        "groups": [
                            {"group": 3, "sum": 1.0819297039522058},
                            {"group": 4, "sum": 528.0516637177401},
                            {"group": 5, "sum": 0.0946450703125},
                        ],
                    },
                    {
                        "group": 5,
                        "groups": [
                            {"group": 4, "sum": 1.7951922632659316},
                            {"group": 5, "sum": 18.58962904117645},
                        ],
                    },
                    {"group": 6, "groups": [{"group": 6, "sum": 0.7569206875}]},
                ],
            },
            {
                "group": 4,
                "groups": [
                    {"group": 1, "groups": [{"group": 1, "sum": 31.43734744678308}]},
                    {
                        "group": 2,
                        "groups": [
                            {"group": 1, "sum": 1.325143578125},
                            {"group": 2, "sum": 347.67522697184586},
                            {"group": 4, "sum": 47.00508255888481},
                        ],
                    },
                    {
                        "group": 3,
                        "groups": [
                            {"group": 1, "sum": 2.272350554105392},
                            {"group": 3, "sum": 4.740651837683823},
                        ],
                    },
                    {
                        "group": 4,
                        "groups": [
                            {"group": 1, "sum": 1.1357797343750002},
                            {"group": 2, "sum": 0.094643546875},
                            {"group": 4, "sum": 2558.2015832283296},
                        ],
                    },
                    {
                        "group": 5,
                        "groups": [
                            {"group": 1, "sum": 0.2839563515625},
                            {"group": 4, "sum": 6.512615603645835},
                            {"group": 5, "sum": 196.14582326875015},
                        ],
                    },
                    {
                        "group": 6,
                        "groups": [
                            {"group": 1, "sum": 0.094646203125},
                            {"group": 4, "sum": 0.5678695703125001},
                            {"group": 6, "sum": 1.893949594362745},
                        ],
                    },
                    {"group": 10, "groups": [{"group": 10, "sum": 0.2839237734375}]},
                ],
            },
        ]
    },
    "2004_2011": {
        "groups": [
            {
                "group": 2,
                "groups": [
                    {"group": 2, "groups": [{"group": 2, "sum": 9.012584721170349}]},
                    {
                        "group": 3,
                        "groups": [
                            {"group": 3, "sum": 68.44437743621329},
                            {"group": 4, "sum": 0.2839917265625},
                        ],
                    },
                    {
                        "group": 4,
                        "groups": [
                            {"group": 3, "sum": 0.6053681041053922},
                            {"group": 4, "sum": 77.36584574932604},
                        ],
                    },
                    {
                        "group": 5,
                        "groups": [
                            {"group": 4, "sum": 0.8519821640625},
                            {"group": 5, "sum": 29.44951926305147},
                        ],
                    },
                    {"group": 8, "groups": [{"group": 4, "sum": 0.094667828125}]},
                    {"group": 10, "groups": [{"group": 10, "sum": 0.4224242577818627}]},
                ],
            },
            {
                "group": 3,
                "groups": [
                    {"group": 2, "groups": [{"group": 2, "sum": 10.210982422824758}]},
                    {
                        "group": 3,
                        "groups": [
                            {"group": 3, "sum": 5.614427620894609},
                            {"group": 4, "sum": 0.0946685625},
                        ],
                    },
                    {
                        "group": 4,
                        "groups": [
                            {"group": 3, "sum": 1.0819297039522058},
                            {"group": 4, "sum": 527.7632030045048},
                            {"group": 5, "sum": 0.0946450703125},
                        ],
                    },
                    {
                        "group": 5,
                        "groups": [
                            {"group": 4, "sum": 0.09912358823529412},
                            {"group": 5, "sum": 20.384821304442383},
                        ],
                    },
                    {"group": 6, "groups": [{"group": 6, "sum": 0.7569206875}]},
                    {"group": 8, "groups": [{"group": 4, "sum": 0.0946685625}]},
                ],
            },
            {
                "group": 4,
                "groups": [
                    {"group": 1, "groups": [{"group": 1, "sum": 30.58546919678308}]},
                    {
                        "group": 2,
                        "groups": [
                            {"group": 1, "sum": 0.75724746875},
                            {"group": 2, "sum": 391.7463127494799},
                            {"group": 3, "sum": 0.47321582812499996},
                            {"group": 4, "sum": 54.57815210220591},
                        ],
                    },
                    {
                        "group": 3,
                        "groups": [
                            {"group": 1, "sum": 0.6625593046875},
                            {"group": 3, "sum": 5.971881391789218},
                        ],
                    },
                    {
                        "group": 4,
                        "groups": [
                            {"group": 1, "sum": 0.75717265625},
                            {"group": 2, "sum": 3.123488007812499},
                            {"group": 3, "sum": 0.0946469609375},
                            {"group": 4, "sum": 2499.387167211921},
                            {"group": 5, "sum": 1.9877017421875003},
                            {"group": 6, "sum": 0.0946507421875},
                        ],
                    },
                    {
                        "group": 5,
                        "groups": [
                            {"group": 4, "sum": 5.845014023560052},
                            {"group": 5, "sum": 200.7655474973961},
                        ],
                    },
                    {
                        "group": 6,
                        "groups": [
                            {"group": 4, "sum": 0.1891988046875},
                            {"group": 6, "sum": 2.3672443599877453},
                        ],
                    },
                    {"group": 10, "groups": [{"group": 10, "sum": 0.2839237734375}]},
                ],
            },
        ]
    },
    "2005": {
        "groups": [
            {
                "group": 2,
                "groups": [
                    {"group": 2, "sum": 9.012584721170349},
                    {"group": 3, "sum": 68.72836916277576},
                    {"group": 4, "sum": 77.97121385343146},
                    {"group": 5, "sum": 30.30150142711396},
                    {"group": 8, "sum": 0.094667828125},
                    {"group": 10, "sum": 0.4224242577818627},
                ],
            },
            {
                "group": 3,
                "groups": [
                    {"group": 2, "sum": 10.210982422824758},
                    {"group": 3, "sum": 5.709096183394609},
                    {"group": 4, "sum": 528.9397777787694},
                    {"group": 5, "sum": 20.483944892677684},
                    {"group": 6, "sum": 0.7569206875},
                    {"group": 8, "sum": 0.0946685625},
                ],
            },
            {
                "group": 4,
                "groups": [
                    {"group": 1, "sum": 30.58546919678308},
                    {"group": 2, "sum": 442.65022967782},
                    {"group": 3, "sum": 6.634440696476718},
                    {"group": 4, "sum": 2510.8226888232916},
                    {"group": 5, "sum": 206.13739848970602},
                    {"group": 6, "sum": 2.5564431646752452},
                    {"group": 10, "sum": 0.2839237734375},
                ],
            },
        ]
    },
}


sub_a_year = {
    1: {"asset": "users/amitghosh/sdg_module/esa/cci_landcover/2009", "year": 2009},
    2: {"year": 2011, "asset": "users/amitghosh/sdg_module/esa/cci_landcover/2011"},
    3: {"asset": "users/amitghosh/sdg_module/esa/cci_landcover/2015", "year": 2015},
    4: {"asset": "users/amitghosh/sdg_module/esa/cci_landcover/2004", "year": 2004},
    5: {"asset": "users/amitghosh/sdg_module/esa/cci_landcover/2005", "year": 2005},
}

sub_b_year = {
    1: {
        2010: {
            "base": {
                "asset": "users/amitghosh/sdg_module/esa/cci_landcover/2004",
                "year": 2004,
            },
            "report": {
                "asset": "users/amitghosh/sdg_module/esa/cci_landcover/2011",
                "year": 2011,
            },
        }
    },
    2: {
        2015: {
            "base": {
                "asset": "users/amitghosh/sdg_module/esa/cci_landcover/2010",
                "year": 2010,
            },
            "report": {
                "asset": "users/amitghosh/sdg_module/esa/cci_landcover/2015",
                "year": 2015,
            },
        }
    },
}


def test_get_sub_b_years():

    expected_result = [
        [
            {
                "asset": "users/amitghosh/sdg_module/esa/cci_landcover/2004",
                "year": 2004,
            },
            {
                "asset": "users/amitghosh/sdg_module/esa/cci_landcover/2011",
                "year": 2011,
            },
        ],
        [
            {
                "asset": "users/amitghosh/sdg_module/esa/cci_landcover/2010",
                "year": 2010,
            },
            {
                "asset": "users/amitghosh/sdg_module/esa/cci_landcover/2015",
                "year": 2015,
            },
        ],
    ]

    assert cs.get_sub_b_years(sub_b_year) == expected_result


def test_get_sub_b_years_labels(sub_b_year):

    expected_result = {2022: "2022_2020", 2015: "2010_2015"}

    assert cs.get_sub_b_years_labels == expected_result
